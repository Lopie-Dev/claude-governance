#!/bin/bash
# Auto-generated by claude-governance
# Secret detection hook

INPUT=$(cat)
TOOL_NAME=$(echo "$INPUT" | jq -r '.tool_name')

# Only check Write/Edit operations
if [[ "$TOOL_NAME" != "Write" && "$TOOL_NAME" != "Edit" ]]; then
  exit 0
fi

CONTENT=$(echo "$INPUT" | jq -r '.tool_input.content // .tool_input.new_string')

{{#each patterns}}
# Check for: {{this.name}}
if echo "$CONTENT" | grep -qE '{{this.pattern}}'; then
  echo "{{this.name}} detected. {{../enforcement.message}}" >&2
  exit 2
fi

{{/each}}
exit 0
